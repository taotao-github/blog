(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{533:function(s,a,n){"use strict";n.r(a);var t=n(46),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"mongodb4-x账户权限配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mongodb4-x账户权限配置"}},[s._v("#")]),s._v(" mongoDB4.x账户权限配置")]),s._v(" "),n("h2",{attrs:{id:"_1-创建超级管理员用户"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建超级管理员用户"}},[s._v("#")]),s._v(" 1. 创建超级管理员用户")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use admin\n switched to db admin\n "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.createUser"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" user:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'admin'")]),s._v(", pwd:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),s._v(", roles:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("role:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v(",db:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'admin'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n Successfully added user: "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin"')]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"roles"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"role"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v(",\n                         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin"')]),s._v("\n                 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("blockquote",[n("p",[s._v("* 使用show users可以查看挡枪数据库有哪些用户")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("users")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin.admin"')]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin"')]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin"')]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"roles"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"role"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v(",\n                         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin"')]),s._v("\n                 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mechanisms"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                 "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SCRAM-SHA-1"')]),s._v(",\n                 "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SCRAM-SHA-256"')]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("blockquote",[n("p",[s._v("* 使用db.dropUSer('admin')删除指定的用户。成功返回true")])]),s._v(" "),n("h2",{attrs:{id:"_2-修改mongodb数据库配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-修改mongodb数据库配置文件"}},[s._v("#")]),s._v(" 2. 修改mongoDB数据库配置文件")]),s._v(" "),n("p",[s._v("找到mongoDB数据库的配置文件：C:/ProgramFiles/MongoDB/Server/4.0/bin/mongod.cfg（默认安装位置）。然后按照如下配置：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("security：\n     authorization:enabled "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意缩进，参照其他的值来改，若是缩进不对可能导致后面服务不能重启")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"_3-重启mongodb服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-重启mongodb服务"}},[s._v("#")]),s._v(" 3. 重启mongoDB服务")]),s._v(" "),n("p",[s._v("配置完成后，重启服务：找到服务，右击重启服务。")]),s._v(" "),n("img",{attrs:{src:s.$withBase("/images/mongodb/配置账户权限重启服务报错.png")}}),s._v(" "),n("p",[s._v("**原因：**配置时缩进不对。enabled前面有一个空格")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("security：\n     authorization: enabled "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意缩进，参照其他的值来改，若是缩进不对可能导致后面服务不能重启")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("修改后就能成功启动服务了。")]),s._v(" "),n("h2",{attrs:{id:"_4-使用创建的权限账户连接mongodb数据库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-使用创建的权限账户连接mongodb数据库"}},[s._v("#")]),s._v(" 4. 使用创建的权限账户连接mongoDB数据库")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("首先使用原来的mongo命令进行连接数据库")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("C:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("DELL"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("mongo\nMongoDB shell version v4.0.8\nconnecting to: mongodb://127.0.0.1:27017/?gssapiServiceName"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mongodb\nImplicit session: session "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" UUID  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"80526735-4e9c-4f54-88d1-87db64d96376"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nMongoDB server version: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.0")]),s._v(".8\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show dbs "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置了账户权限，使用mong命令也能进去，但是其他操作不会返回任何数据信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("断开mongoDB连接，使用账户权限连接。")]),s._v(" "),n("ul",[n("li",[s._v("命令格式：mongo admin -u 用户名 -p密码")]),s._v(" "),n("li",[s._v("mongo 192.168.1.200:27017/test -u user -password")]),s._v(" "),n("li",[s._v("基本格式： mongo 某个数据库名 -u 用户 -p密码")])]),s._v(" "),n("p",[s._v("下面我们使用之前创建的用户进行数据库的连接")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("connecting to: mongodb://127.0.0.1:27017/admin?gssapiServiceName"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mongodb\nImplicit session: session "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" UUID  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"306c2083-c305-4089-8d69-6b265f5e4240"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nMongoDB server version: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.0")]),s._v(".8\n…\nTo "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" monitoring, run the following command: db.enableFreeMonitoring  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nTo permanently disable this remind\ter, run the following command:   db.disableFreeMonitoring"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n---\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用账户权限登录后，就可以对数据库进行操作了。")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])])])])])}),[],!1,null,null,null);a.default=e.exports}}]);